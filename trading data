<!DOCTYPE html>
<html>
<head>
  <title>XIAN Trades Viewer</title>
</head>
<body>
  <h1>Swap Events (Pair 21)</h1>
  <table border="1" id="results">
    <tr>
      <th>Created</th>
      <th>Signer</th>
      <th>amount0In</th>
      <th>amount1In</th>
      <th>amount0Out</th>
      <th>amount1Out</th>
    </tr>
  </table>

  <script>
    const query = `
    query {
      allEvents(
        condition: { contract: "con_pairs", event: "Swap" }
        filter: {
          dataIndexed: { contains: { pair: "21" } }
          created: {
            greaterThanOrEqualTo: "2025-06-20T00:00:00"
            lessThan: "2025-06-28T00:00:00"
          }
        }
        orderBy: CREATED_DESC
        first: 50
      ) {
        edges {
          node {
            created
            signer
            data
          }
        }
      }
    }
    `;

    fetch("https://node.xian.org/graphql", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ query })
    })
    .then(res => res.json())
    .then(res => {
      const rows = res.data.allEvents.edges.map(edge => edge.node);
      const table = document.getElementById("results");
      rows.forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${row.created}</td>
          <td>${row.signer}</td>
          <td>${row.data.amount0In}</td>
          <td>${row.data.amount1In}</td>
          <td>${row.data.amount0Out}</td>
          <td>${row.data.amount1Out}</td>
        `;
        table.appendChild(tr);
      });
    });
  </script>
</body>
</html>
